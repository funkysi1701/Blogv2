@page "/tag/{tagname}"
@inject BlogService BlogService

<PageTitle>@TagName - Funky Si's Blog</PageTitle>
<h2>Blog Posts with Tag of @TagName</h2>

@if (blogs == null || blogs.Count == 0)
{
    <p><em>Loading...</em></p>
}
else
{
    <div>
    <Virtualize Items="@blogs" Context="post">
        <ItemContent>
            <div>
                <h4><a href="/posts/@post.Slug">@post.Title</a></h4>
                <p>
                    <small>@post.Published_At.Value.ToString("dd MMMM yyyy", CultureInfo.CurrentCulture)</small>
                    &nbsp;@post.Description
                </p>
            </div>
        </ItemContent>
    </Virtualize>
    </div>
}

@code{
	[Parameter]
	public string TagName { get; set; }
	protected List<BlogPosts> blogs = new();

	protected override async Task OnInitializedAsync()
	{
		blogs = await BlogService.GetBlogsAsync(100);
		blogs = blogs.Where(x => x.Tag_List.Contains(TagName.ToLower())).ToList();
	}
}